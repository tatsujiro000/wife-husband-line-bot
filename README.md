# 奥様の愚痴を旦那様に伝えるLINE Botシステム

## 概要
このシステムは、奥様が日々の愚痴をLINE Botを通じて投稿し、それをバックエンドシステム（Dify）が分析・処理して、旦那様へ適切なメッセージとして送信するシステムです。データベースにはSupabaseを利用しています。

## システム構成
- LINE Bot (奥様用)：奥様が愚痴を投稿するためのLINE Bot
- LINE Bot (旦那様用)：旦那様がメッセージを受け取るためのLINE Bot
- Dify (バックエンド)：奥様の愚痴を受け取り、分析・処理を行い、旦那様へのメッセージを作成するバックエンドシステム
- Supabase (データベース)：愚痴の内容、送信履歴、設定情報などを保存
- Render (デプロイ環境)：Difyのバックエンドシステムを稼働させるクラウド環境

## 機能
1. 奥様の愚痴のキャッチ (LINE Bot - 奥様用)
2. 旦那様へのメッセージ送信 (LINE Bot - 旦那様用)
3. 愚痴の分析と処理 (Dify)
4. 奥様の体調・メンタルを気遣うメッセージ送信

## 開発環境のセットアップ
1. リポジトリをクローン
```
git clone <repository-url>
cd with_wife_ver2.0
```

2. 依存関係のインストール
```
npm install
```

3. 環境変数の設定
`.env.example`ファイルをコピーして`.env`ファイルを作成し、必要な環境変数を設定してください。
```
cp .env.example .env
```

4. 開発サーバーの起動
```
npm run dev
```

5. ビルド
```
npm run build
```

6. 本番環境での実行
```
npm start
```

## Supabaseのセットアップ
1. Supabaseアカウントを作成し、新しいプロジェクトを作成します。
2. 必要なテーブルを作成します（詳細は`docs/database.md`を参照）。
3. Supabaseの接続情報を`.env`ファイルに設定します。

## LINEボットのセットアップ
1. LINE Developersアカウントを作成し、2つのMessaging APIチャネルを作成します（奥様用と旦那様用）。
2. Webhook URLを設定します。
3. チャネルシークレットとアクセストークンを`.env`ファイルに設定します。

## Difyのセットアップ
1. Difyアカウントを作成し、新しいアプリケーションを作成します。
2. APIキーを取得し、`.env`ファイルに設定します。

## デプロイ方法
Renderを使用してデプロイする手順は`docs/deployment.md`を参照してください。

## ライセンス
このプロジェクトはMITライセンスの下で公開されています。 